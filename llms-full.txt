---
url: /blog/mnfzkey3/index.md
---
# 自定义组件

---

---
url: /blog/tkvga9m6/index.md
---
## 标题H2

### 标题H3

#### 标题H4

##### 标题H5

###### 标题H6

## 标题2 Badge&#x20;

### 标题3 Badge&#x20;

#### 标题4 Badge&#x20;

正文内容。

`@property` CSS at-rule是 [CSS Houdini API](https://developer.mozilla.org/zh-CN/docs/Web/Guide/Houdini)
的一部分，它允许开发者显式地定义他们的 [CSS 自定义属性](https://developer.mozilla.org/zh-CN/docs/Web/CSS/--*),
允许进行属性类型检查、设定默认值以及定义该自定义属性是否可以被继承。

`@property` 的出现，极大的增强了 CSS 的能力。

加粗：**加粗文字**

斜体： *斜体文字*

\~~删除文字~~

内容 ==标记==

数学表达式： $-(2^{n-1})$ ~ $2^{n-1} -1$

$\frac {\partial^r} {\partial \omega^r} \left(\frac {y^{\omega}} {\omega}\right)
\= \left(\frac {y^{\omega}} {\omega}\right) \left{(\log y)^r + \sum\_{i=1}^r \frac {(-1)^ Ir \cdots (r-i+1) (\log y)^{ri}} {\omega^i} \right}$

19^th^

H~2~O

::: center
内容居中
:::

::: right
内容右对齐
:::

* 无序列表1
* 无序列表2
* 无序列表3

1. 有序列表1
2. 有序列表2
3. 有序列表3

* \[ ] 任务列表1
* \[ ] 任务列表2
* \[x] 任务列表3
* \[x] 任务列表4

| Tables        | Are           | Cool  |
| ------------- |:-------------:| -----:|
| col 3 is      | right-aligned | $1600 |
| col 2 is      | centered      |   $12 |
| zebra stripes | are neat      |    $1 |

> 引用内容
>
> 引用内容

[链接](/)

[外部链接](https://github.com/pengzhanbo)

![plume](/plume.svg)

**Badge：**

**图标：**

* home -&#x20;
* vscode -&#x20;
* twitter -&#x20;

**demo wrapper：**

::: demo-wrapper title="示例" no-padding height="200px"

:::

**代码：**

```js whitespace
const a = 1
const b = 2
const c = a + b

// [!code word:obj]
const obj = {
  toLong: {
    deep: {
      deep: {
        deep: {
          value: 'this is to long text. this is to long text. this is to long text. this is to long text.', // [!code highlight]
        }
      }
    }
  }
}
```

**Code Blocks TwoSlash：**

```ts twoslash
// @errors: 2339
const welcome = 'Tudo bem gente?'
const words = welcome.contains(' ')
```

```ts twoslash
import express from 'express'
const app = express()
app.get('/', (req, res) => {
  res.send
})
app.listen(3000)
```

```ts twoslash
import { createHighlighter } from 'shiki'

const highlighter = await createHighlighter({ themes: ['nord'], langs: ['javascript'] })
// @log: Custom log message
const a = 1
// @error: Custom error message
const b = 1
// @warn: Custom warning message
const c = 1
// @annotate: Custom annotation message
```

```ts twoslash
// @errors: 2540
interface Todo {
  title: string
}

const todo: Readonly<Todo> = {
  title: 'Delete inactive users'.toUpperCase(),
//  ^?
}

todo.title = 'Hello'

Number.parseInt('123', 10)
//      ^|

//
//
```

```vue twoslash
<script setup lang="ts">
import { ref } from 'vue'

const count = ref(0)
</script>

<template>
  <p>{{ count }}</p>
</template>
```

**代码分组：**

::: code-tabs
@tab tab1

```js
const a = 1
const b = 2
const c = a + b
```

@tab tab2

```ts
const a: number = 1
const b: number = 2
const c: number = a + b
```

:::

**代码块高亮：**

```ts
function foo() {
  const a = 1 // [!code highlight]

  console.log(a)

  const b = 2 // [!code ++]
  const c = 3 // [!code --]

  console.log(a + b + c) // [!code error]
  console.log(a + b) // [!code warning]
}
```

**代码块聚焦：**

```ts
function foo() {
  const a = 1 // [!code focus]
}
```

::: tip 仅标题
:::

::: note 注释
注释内容 [link](https://github.com/pengzhanbo) `inline code`

```js
const a = 1
const b = 2
const c = a + b
```

:::

::: info 信息
信息内容 [link](https://github.com/pengzhanbo) `inline code`

```js
const a = 1
const b = 2
const c = a + b
```

:::

::: tip 提示
提示内容 [link](https://github.com/pengzhanbo) `inline code`

```js
const a = 1
const b = 2
const c = a + b
```

:::

::: warning 警告
警告内容 [link](https://github.com/pengzhanbo) `inline code`

```js
const a = 1
const b = 2
const c = a + b
```

:::

::: caution 错误
错误内容 [link](https://github.com/pengzhanbo) `inline code`

```js
const a = 1
const b = 2
const c = a + b
```

:::

::: important 重要
重要内容 [link](https://github.com/pengzhanbo) `inline code`

```js
const a = 1
const b = 2
const c = a + b
```

:::

::: details 详细标题

这里是内容。
:::

**GFM alert：**

> \[!note]
> note

> \[!info]
> info

> \[!tip]
> tip

> \[!warning]
> warning

> \[!caution]
> caution

> \[!important]
> important

**代码演示：**

:::: demo title="常规示例" desc="一个常规示例"

::: code-tabs
@tab HTML

```html
<div id="app">
  <h3>vuepress-theme-plume</h3>
</div>
```

@tab Javascript

```js
const a = 'So Awesome!'
const app = document.querySelector('#app')
app.appendChild(window.document.createElement('small')).textContent = a
```

@tab CSS

```css
#app {
  font-size: 2em;
  text-align: center;
}
```

:::
::::

**选项卡：**

::: tabs
@tab 标题1
内容区块

@tab 标题2
内容区块
:::

:::: warning
::: tabs
@tab 标题1
内容区块

@tab 标题2
内容区块
:::
::::

**脚注：**

脚注 1 链接\[^first]。

脚注 2 链接[^second]。

行内的脚注^\[行内脚注文本] 定义。

重复的页脚定义[^second]。

\[^first]: 脚注 **可以包含特殊标记**

```
也可以由多个段落组成
```

[^second]: 脚注文字。

---

---
url: /demo/index.md
---
# Demo
* [bar](./bar.md)
* [foo](./foo.md)

---

---
url: /demo/0qv9o9ph/index.md
---
# foo
[bar](./bar.md)

---

---
url: /demo/b3re7du2/index.md
---
# bar
[foo](./foo.md)

---

---
url: /develop/index.md
---
# 介绍
## 项目简介

该项目是一个基于==Cloudflare Worker==开发的一套==面向多平台软件的全域授权管理与数据分析SaaS平台=={.info}

---

---
url: /develop/backend/index.md
---
# 介绍
## 简介

后端的代码全都是运行在==cloudflare worker==环境下的，近似于浏览器环境

::: table full-width

| Cloudflare存储 | 特性           | 类似于        |
| -------------- | -------------- | ------------- |
| D1             | 关系型数据库   | MySQL、SQLite |
| KV             | 键值对数据库   | Redis         |
| R2             | 对象存储数据库 | Minio         |

:::

## 环境变量

这里的环境变量可以在==wrangler.jsonc==中进行定义，在执行==wrangler deploy==的时候，会自动将==wrangler.jsonc==中的变量值上传至该项目对应的worker中去。

## 完整的配置文件

后端绑定的数据库和环境变量都要在自己的==wrangler.jsonc==中进行赋值

::: code-tabs

@tab wrangler.jsonc

```json
{
  "$schema": "node_modules/wrangler/config-schema.json",
  "name": "authgenie",
  "main": "src/index.ts",
  "compatibility_date": "2025-12-03"
  // "compatibility_flags": [
  //   "nodejs_compat"
  // ],
  // "vars": {
  //   "MY_VAR": "my-variable"
  // },
  // "kv_namespaces": [
  //   {
  //     "binding": "MY_KV_NAMESPACE",
  //     "id": "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
  //   }
  // ],
  // "r2_buckets": [
  //   {
  //     "binding": "MY_BUCKET",
  //     "bucket_name": "my-bucket"
  //   }
  // ],
  // "d1_databases": [
  //   {
  //     "binding": "MY_DB",
  //     "database_name": "my-database",
  //     "database_id": ""
  //   }
  // ],
  // "ai": {
  //   "binding": "AI"
  // },
  // "observability": {
  //   "enabled": true,
  //   "head_sampling_rate": 1
  // }
}
```

:::

---

---
url: /develop/backend/database/index.md
---
# 数据库
## 一、D1数据库

### 系统管理员表（admin）

::: table full-width align="center" hl-rows="tip:1" hl-cols="success:1"

| 字段名        | 类型    | 主键 | 说明                     |
|---------------|---------|------|--------------------------|
| id            | TEXT    | 是   | 雪花 ID / UUID           |
| username      | TEXT    | 否   | 管理员账号               |
| email         | TEXT    | 否   | 登录邮箱                 |
| password\_hash | TEXT    | 否   | 哈希密码                 |
| canBeUsed     | INTEGER | 否   | 0 禁用 / 1 启用          |
| updateTime    | TEXT    | 否   | 更新时间（ISO）          |
| createTime    | TEXT    | 否   | 创建时间（ISO）          |

:::

### 操作审计日志（audit\_log）

::: table full-width align="center" hl-rows="tip:1" hl-cols="success:1"
| 字段名     | 类型    | 主键 | 说明                            |
|------------|---------|------|---------------------------------|
| id         | TEXT    | 是   | ID                              |
| actor\_type | TEXT    | 否   | admin / user                    |
| actor\_id   | TEXT    | 否   | 操作者 ID                       |
| action     | TEXT    | 否   | login / create\_project ...      |
| detail     | TEXT    | 否   | 扩展 JSON                       |
| ip         | TEXT    | 否   | 操作 IP                         |
| createTime | TEXT    | 否   | 时间戳                          |

### 用户表（user）

::: table full-width align="center" hl-rows="tip:1" hl-cols="success:1"
| 字段名     | 类型    | 主键 | 说明                           |
|------------|---------|------|--------------------------------|
| id         | TEXT    | 是   | 用户 ID（UUID）                |
| username   | TEXT    | 否   | 用户名（GitHub login）         |
| email      | TEXT    | 否   | GitHub 邮箱（可能为空）        |
| avatar     | TEXT    | 否   | GitHub 头像 URL                |
| github\_id  | TEXT    | 否   | GitHub User ID                 |
| canBeUsed  | INTEGER | 否   | 1 可用 / 0 禁用                |
| updateTime | TEXT    | 否   | 更新时间（ISO）                |
| createTime | TEXT    | 否   | 创建时间（ISO）                |

:::

### 团队表（team）

::: table full-width align="center" hl-rows="tip:1" hl-cols="success:1"
| 字段名     | 类型 | 主键 | 说明             |
|------------|------|------|------------------|
| id         | TEXT | 是   | 团队 ID          |
| name       | TEXT | 否   | 团队名称         |
| owner\_id   | TEXT | 否   | 创建者 user.id   |
| createTime | TEXT | 否   | 创建时间         |
| updateTime | TEXT | 否   | 更新时间         |

:::

### 团队成员表（team\_member）

::: table full-width align="center" hl-rows="tip:1" hl-cols="success:1"
| 字段名     | 类型 | 主键 | 说明                           |
|------------|------|------|--------------------------------|
| id         | TEXT | 是   | ID                             |
| team\_id    | TEXT | 否   | 团队 ID                        |
| user\_id    | TEXT | 否   | 用户 ID                        |
| role       | TEXT | 否   | owner / admin / member         |
| createTime | TEXT | 否   | 加入时间                       |

:::

### 项目表（project）

::: table full-width align="center" hl-rows="tip:1" hl-cols="success:1"
| 字段名      | 类型 | 主键 | 说明         |
|-------------|------|------|--------------|
| id          | TEXT | 是   | 项目 ID      |
| team\_id     | TEXT | 否   | 所属团队 ID  |
| name        | TEXT | 否   | 项目名称     |
| description | TEXT | 否   | 项目简介     |
| createTime  | TEXT | 否   | 创建时间     |
| updateTime  | TEXT | 否   | 更新时间     |

:::

### License 表（license）

::: table full-width align="center" hl-rows="tip:1" hl-cols="success:1"
| 字段名         | 类型    | 主键 | 说明                           |
|----------------|---------|------|--------------------------------|
| id             | TEXT    | 是   | License ID                     |
| project\_id     | TEXT    | 否   | 所属项目                       |
| key            | TEXT    | 否   | 授权密钥（哈希/加密存储）     |
| type           | TEXT    | 否   | trial / paid / internal / life |
| max\_activation | INTEGER | 否   | 最大激活次数                   |
| expireAt       | TEXT    | 否   | 到期时间                       |
| meta\_json      | TEXT    | 否   | JSON 扩展数据                  |
| createTime     | TEXT    | 否   | 创建时间                       |
| updateTime     | TEXT    | 否   | 更新时间                       |

:::

## 二、KV数据库

### SessionID

Key: `session:{session_id}`\
Value(JSON):

| 字段        | 说明                     |
|-------------|--------------------------|
| user\_id     | 用户 ID                  |
| ip          | 登录 IP                  |
| ua          | User-Agent               |
| expireAt    | 过期时间（ISO）         |
| createTime  | 创建时间                 |

---

---
url: /develop/codefiletree/index.md
---
# 项目文件结构
::: file-tree

* .wrangler
  * ...
* node\_modules
  * ...
* src  所有**后端**核心代码都在这里
  * index.ts  代码入口
* .gitignore
* package-lock.json
* package.json
* README.md
* tsconfig.json
* wrangler.jsonc
* ...
  :::

---

---
url: /develop/dev/index.md
---
# 开始调试
## 调试后端

进入项目根目录(==wrangler.jsonc==所在的目录)，执行：

```bash
wrangler dev
```

---

---
url: /develop/getcode/index.md
---
# 获取代码
## 拉取后端代码

```bash
git clone https://github.com/only9464/AuthGenie-Docs.git
```

---

---
url: /develop/installenv/index.md
---
# 安装环境和依赖
## 一、安装Git

Git官方：<https://github.com/git>

## 二、安装nvm

Windows：<https://github.com/coreybutler/nvm-windows>

安装完成后，使用nvm初始化一个node环境：

```bash
nvm i 22
nvm use 22
```

## 三、安装Wrangler

::: npm-to

```bash
npm i wrangler@latest -g
```

:::

---

---
url: /doc/index.md
---
# 其他文档
这是一个基于cloudflare worker项目的**面向多平台软件的全域授权管理与数据分析SaaS平台**。

关系型数据库使用cloudflare worker的D1数据库、R2数据库、KV数据库，还有能够使用cloudflare worker提供的环境变量来存储一些必要的数据。
后端web框架使用hono框架，数据库orm采用dizzle orm。

系统总共分三个角色：
系统超级管理员（只有一个账号，账号密码都存储到环境变量中）
系统管理员（只能由系统超级管理员创建）
系统用户（可以自己注册）

三个系统角色的功能：

系统超级管理员：管理系统管理员账号、查看系统管理员操作日志等等

系统管理员：管理系统用户账号（停用、启用）、管理系统用户创建的团队（停用、启用、删除）、管理系统用户创建的团队旗下的项目（停用、启用、删除）、查看系统用户的操作日志等等

系统用户：管理团队（创建、删除）、管理团队旗下的项目（创建、删除）、查看项目数据（某个天数之内的访问量、用户唯一标识、许可证编号）、批量生成项目许可证、查看许可证信息（绑定的用户唯一标识、创建时间、第一次使用时间、最后一次验证时间）、加入别人的团队等等

所以系统会开发出一个前端站点，根路由是官网首页，会展示这个网站的功能、教程等信息，并提供三种系统角色的不同的登录入口。
每一种角色有自己专属的dashboard。系统用户可以创建自己的团队，团队成员可以查看团队下的所有项目的所有信息，具有相关的所有权限。
还可以批量生成许可证，许可证是用来验证系统用户创建的项目（比如发布在windows、mac、linux、Android上的软件）的用户是否有使用权限的。

以上所有凭证的验证接口是统一的后端接口路由是：/api/vertify,采用POST请求，格式是json
其中的数据包括但不限于：客户端的时间、客户端传来的系统凭证、客户端传来的许可证凭证、项目的ID（这是我这个系统用户创建的所有项目中所会有的唯一的ID），返回的数据是系统时间、许可证验证结果（是否通过）

以下是其相关的具体文档：

[需求分析说明书](./requirements.md)

[关键技术研究报告](./technologyResearch.md)

[概要设计说明书](./outlineDesign.md)

---

---
url: /doc/outlineDesign/index.md
---
# 概要设计说明书
## 一、引言

### 1.1 编写目的

给出 AuthGenie（灵域）系统的总体设计、模块划分与接口要点，作为研发与协作的统一参考。

### 1.2 项目背景

本系统为面向多平台软件授权管理与数据分析的 SaaS 平台，基于 Cloudflare Workers 构建，提供官网门户、角色化 Dashboard、统一授权验证接口与数据统计能力。

### 1.3 术语

| 缩写/术语 | 解释 |
| --- | --- |
| Cloudflare Workers | Serverless 运行环境 |
| D1 | 关系型数据库 |
| R2 | 对象存储 |
| KV | 键值存储 |
| 许可证 | 项目授权凭证 |
| 项目 ID | 项目唯一标识 |

### 1.4 参考资料

* `docs/doc/README.md`

## 二、任务概述

### 2.1 系统描述

系统按三类角色提供不同权限的管理与数据视图，支持团队/项目管理、许可证生成与验证、访问数据统计与日志审计。

### 2.2 运行环境

* 运行平台：Cloudflare Workers。
* 存储：D1（结构化数据）、R2（对象资源）、KV（轻量配置/缓存）。
* 敏感信息：通过环境变量提供（超级管理员账号与密码等）。

### 2.3 条件与限制

* 系统管理员账号仅由系统超级管理员创建。
* 验证接口 `/api/vertify` 为统一授权入口。
* 所有关键操作需记录操作日志以备审计。

## 三、总体设计

### 3.1 系统设计原则

* 轻量化与 Serverless 优先。
* 权限边界清晰，角色分权。
* 接口统一，跨平台行为一致。
* 操作可追溯，日志完整。

### 3.2 系统结构

```
[官网门户/角色登录]
        |
        v
[角色 Dashboard] <-> [Workers API / Hono]
                               |
               +---------------+---------------+
               |                               |
             [D1]                           [R2/KV]
```

### 3.3 处理流程（概要）

1. 系统用户创建团队与项目，生成项目唯一 ID。
2. 系统用户批量生成许可证并分发给客户端。
3. 客户端调用 `/api/vertify` 进行授权校验。
4. 后端记录校验日志并沉淀统计数据。

### 3.4 模块划分

* **账户与角色模块**：超级管理员/系统管理员/系统用户的身份与权限。
* **团队模块**：团队创建、成员加入、团队状态管理。
* **项目模块**：项目创建、状态管理、项目 ID 管理。
* **许可证模块**：批量生成、查询详情、验证记录。
* **统计模块**：按时间范围统计访问量、用户唯一标识、许可证编号。
* **日志模块**：管理员与用户操作日志。
* **验证接口模块**：统一授权校验入口。
* **门户与 Dashboard**：官网首页与角色化管理界面。

### 3.5 功能需求与模块关系（简述）

* 角色与权限 -> 账户与角色模块 + 日志模块。
* 团队/项目管理 -> 团队模块 + 项目模块。
* 许可证生成与验证 -> 许可证模块 + 验证接口模块。
* 数据统计 -> 统计模块。

### 3.6 尚未解决的问题

* 许可证规则扩展（如试用期、离线授权）仍需后续补充设计。

## 四、接口设计

### 4.1 外部接口

* **授权验证**：`POST /api/vertify`，JSON 请求体，包含客户端时间、系统凭证、许可证凭证、项目 ID；响应包含系统时间与验证结果。
* **门户入口**：官网首页提供三类角色登录入口与教程内容。

### 4.2 内部接口

* 许可证模块依赖项目模块的项目 ID 与归属关系。
* 统计模块依赖验证接口模块写入的校验日志。

## 五、数据结构设计（概要）

### 5.1 主要实体

* **用户**：系统用户基础信息、状态。
* **管理员**：系统管理员/超级管理员信息、状态。
* **团队**：名称、成员、状态。
* **项目**：名称、团队归属、项目 ID、状态。
* **许可证**：编号、绑定用户唯一标识、创建时间、首次使用、最后验证时间。
* **日志**：操作者、对象、时间、结果。

## 六、数据库设计（概要）

* **D1**：用户、管理员、团队、项目、许可证、日志等结构化数据。
* **KV**：轻量配置与缓存。
* **R2**：对象资源（如导出文件、媒体等）。

## 七、用户界面设计（概要）

* 官网首页：展示功能/教程，提供角色登录入口。
* 角色 Dashboard：按权限展示团队、项目、许可证、统计等功能。

## 八、出错处理设计（概要）

* **认证/授权错误**：提示无权限或凭证无效。
* **资源不存在**：提示项目/团队/许可证不存在。
* **系统错误**：提示服务不可用并记录日志。

---

---
url: /doc/requirements/index.md
---
# 需求分析说明书
## 一、引言

### 1.1 目的

明确 AuthGenie（灵域）平台的业务范围、功能需求与非功能需求，作为产品、研发、测试与运维的统一依据。

### 1.2 背景

* 项目名称：AuthGenie（灵域）
* 项目定位：面向多平台软件（Windows/macOS/Linux/Android 等）的授权管理与数据分析 SaaS。
* 运行形态：基于 Cloudflare Workers 的服务端应用，提供官网门户与角色化 Dashboard。
* 存储体系：D1（关系型数据）、R2（对象存储）、KV（轻量配置/缓存）；敏感配置使用环境变量。
* 后端技术：Hono 作为 Web 框架，Drizzle ORM 作为数据库访问层。

### 1.3 术语

| 缩写/术语 | 解释 |
| --- | --- |
| Cloudflare Workers | Serverless 运行环境 |
| D1 | Cloudflare 关系型数据库 |
| R2 | Cloudflare 对象存储 |
| KV | Cloudflare 键值存储 |
| Hono | 轻量 Web 框架 |
| Drizzle ORM | TypeScript ORM |
| 许可证 | 项目授权凭证 |
| 项目 ID | 项目的唯一标识，用于授权验证 |

### 1.4 参考资料

* `docs/doc/README.md`

## 二、软件系统描述

### 2.1 软件介绍与范围

系统提供团队与项目管理、许可证生成与验证、项目访问统计等能力，并支持多角色分权管理。

**包含范围**：

* 官网门户与角色登录入口。
* 系统超级管理员/系统管理员/系统用户三类角色权限体系。
* 团队与项目管理。
* 许可证管理与统一验证接口。
* 项目数据统计与操作日志查看。

**不包含范围**：

* 客户端 SDK/授权库的具体实现。
* 线下销售与付款系统。
* 第三方授权系统迁移工具（如需另行规划）。

### 2.2 功能概述

* 角色与权限管理：按角色划分功能与访问权限。
* 团队与项目管理：创建、删除、启用/停用。
* 许可证管理：批量生成、详情查询、验证记录。
* 数据统计：按项目与时间范围展示访问数据。
* 统一验证接口：提供跨平台一致校验入口。
* 操作日志：管理员层级可审计用户操作。

## 三、软件功能性需求

### 3.1 角色与权限

* **系统超级管理员**
  * 管理系统管理员账号（创建/禁用/重置）。
  * 查看系统管理员操作日志。
* **系统管理员**
  * 管理系统用户账号（启用/停用）。
  * 管理系统用户创建的团队与项目（启用/停用/删除）。
  * 查看系统用户操作日志。
* **系统用户**
  * 创建/删除团队；加入他人团队。
  * 管理团队下的项目（创建/删除）。
  * 批量生成许可证；查看许可证详情。
  * 查看项目数据（访问量、用户唯一标识、许可证编号）。

### 3.2 团队与项目管理

* 团队作为协作单位，成员可共享团队下项目数据。
* 项目必须归属团队，生成唯一项目 ID。
* 项目支持启用/停用/删除（管理员可强制操作）。

### 3.3 许可证管理

* 支持批量生成许可证并绑定项目。
* 许可证详情包含：
  * 绑定的用户唯一标识
  * 创建时间
  * 第一次使用时间
  * 最后一次验证时间

### 3.4 数据与统计

* 支持按指定天数范围查询项目访问量。
* 支持查看访问相关用户唯一标识与许可证编号。

### 3.5 统一授权验证接口

* **接口**：`POST /api/vertify`，JSON 请求体。
* **请求包含**：
  * 客户端时间
  * 系统凭证
  * 许可证凭证
  * 项目 ID
* **响应包含**：
  * 系统时间
  * 验证结果（是否通过）

### 3.6 门户与 Dashboard

* 官网首页提供功能介绍、教程与角色入口。
* 每类角色拥有专属 Dashboard 与功能菜单。

## 四、非功能性需求

### 4.1 用户界面需求

* Web 端界面，按角色显示不同功能与数据。
* 首页强调功能入口与教程信息。

### 4.2 性能与可用性

* 验证接口应支持高并发请求，优先保证响应及时性。
* 核心数据与日志应可追溯、可审计。

### 4.3 安全与合规

* 超级管理员账号与敏感配置通过环境变量管理。
* 角色权限隔离，管理员不可越权访问用户数据。
* 验证接口需校验系统凭证与许可证凭证。

### 4.4 软/硬件环境需求

* Cloudflare Workers 运行环境。
* D1、R2、KV 作为存储基础。
* 后端采用 Hono + Drizzle ORM。

---

---
url: /doc/technologyResearch/index.md
---
# 关键技术研究报告
## 一、关键技术与问题1：Cloudflare Workers 数据存储组合

### 1.1 问题描述

系统同时需要结构化业务数据、对象资源与高频配置/缓存，必须与 Workers 运行环境兼容，并保持较低运维成本。

### 1.2 可能的解决方案

* 方案 A：仅使用 D1 统一存储所有数据。
* 方案 B：D1 + R2 + KV 分层存储（结构化/对象/配置）。
* 方案 C：引入第三方数据库与对象存储（增加运维复杂度）。

### 1.3 验证思路

* 使用 PoC 评估 D1 在关系型数据上的建模与查询性能。
* 使用 R2 存放对象文件（如导出文件），验证读写与访问控制。
* 使用 KV 存放配置与高频读取数据，验证延迟与一致性表现。

### 1.4 选择与原因

采用 **D1 + R2 + KV** 组合：

* D1 处理核心业务数据（用户/团队/项目/许可证/日志）。
* R2 用于对象资源存储（如报表导出、附件等）。
* KV 用于轻量配置与缓存。
* 与 Workers 原生生态兼容，部署与运维成本最低。

## 二、关键技术与问题2：统一许可证验证接口

### 2.1 问题描述

多平台客户端需要统一的授权校验入口，保证跨平台行为一致，返回可用于客户端判断的权威结果。

### 2.2 可能的解决方案

* 方案 A：在各端实现本地校验逻辑（一致性与更新难度高）。
* 方案 B：统一后端校验接口（客户端只调用 API）。

### 2.3 验证思路

* 设计统一接口 `/api/vertify`，验证请求格式与响应规范。
* 在模拟多平台客户端的情况下验证一致性与性能。

### 2.4 选择与原因

选择 **统一后端校验接口**：

* 行为一致，便于集中管理授权策略。
* 便于审计与统计（日志可统一记录）。
* 更适合后续扩展风控或策略变更。

## 三、关键技术与问题3：角色权限与审计

### 3.1 问题描述

系统包含三层角色，需要清晰的权限边界与可追溯的操作日志。

### 3.2 可能的解决方案

* 方案 A：简单角色字段 + 硬编码权限。
* 方案 B：角色权限表 + 操作日志模块化管理。

### 3.3 验证思路

* 基于角色配置的功能访问控制。
* 操作日志记录关键行为（创建/删除/禁用）。

### 3.4 选择与原因

采用 **角色权限与日志模块化设计**，满足审计与权限隔离需求。

## 四、关键技术与问题4：Workers 后端框架与 ORM

### 4.1 问题描述

Workers 环境需要轻量 Web 框架与类型安全的数据访问层，兼顾性能与可维护性。

### 4.2 可能的解决方案

* Web 框架：Hono / 其它轻量框架。
* ORM：Drizzle ORM / 直接 SQL。

### 4.3 选择与原因

采用 **Hono + Drizzle ORM**：

* Hono 适配 Workers、路由清晰、性能好。
* Drizzle 提供类型安全与易维护的数据库访问层。

---

---
url: /faq/index.md
---
# 常见问题
本文主要包含了使用该项目的过程中可能会遇到的常见问题与解决方法。
