---
url: /doc/technologyResearch/index.md
---
## 一、关键技术与问题1：Cloudflare Workers 数据存储组合

### 1.1 问题描述

系统同时需要结构化业务数据、对象资源与高频配置/缓存，必须与 Workers 运行环境兼容，并保持较低运维成本。

### 1.2 可能的解决方案

* 方案 A：仅使用 D1 统一存储所有数据。
* 方案 B：D1 + R2 + KV 分层存储（结构化/对象/配置）。
* 方案 C：引入第三方数据库与对象存储（增加运维复杂度）。

### 1.3 验证思路

* 使用 PoC 评估 D1 在关系型数据上的建模与查询性能。
* 使用 R2 存放对象文件（如导出文件），验证读写与访问控制。
* 使用 KV 存放配置与高频读取数据，验证延迟与一致性表现。

### 1.4 选择与原因

采用 **D1 + R2 + KV** 组合：

* D1 处理核心业务数据（用户/团队/项目/许可证/日志）。
* R2 用于对象资源存储（如报表导出、附件等）。
* KV 用于轻量配置与缓存。
* 与 Workers 原生生态兼容，部署与运维成本最低。

## 二、关键技术与问题2：统一许可证验证接口

### 2.1 问题描述

多平台客户端需要统一的授权校验入口，保证跨平台行为一致，返回可用于客户端判断的权威结果。

### 2.2 可能的解决方案

* 方案 A：在各端实现本地校验逻辑（一致性与更新难度高）。
* 方案 B：统一后端校验接口（客户端只调用 API）。

### 2.3 验证思路

* 设计统一接口 `/api/vertify`，验证请求格式与响应规范。
* 在模拟多平台客户端的情况下验证一致性与性能。

### 2.4 选择与原因

选择 **统一后端校验接口**：

* 行为一致，便于集中管理授权策略。
* 便于审计与统计（日志可统一记录）。
* 更适合后续扩展风控或策略变更。

## 三、关键技术与问题3：角色权限与审计

### 3.1 问题描述

系统包含三层角色，需要清晰的权限边界与可追溯的操作日志。

### 3.2 可能的解决方案

* 方案 A：简单角色字段 + 硬编码权限。
* 方案 B：角色权限表 + 操作日志模块化管理。

### 3.3 验证思路

* 基于角色配置的功能访问控制。
* 操作日志记录关键行为（创建/删除/禁用）。

### 3.4 选择与原因

采用 **角色权限与日志模块化设计**，满足审计与权限隔离需求。

## 四、关键技术与问题4：Workers 后端框架与 ORM

### 4.1 问题描述

Workers 环境需要轻量 Web 框架与类型安全的数据访问层，兼顾性能与可维护性。

### 4.2 可能的解决方案

* Web 框架：Hono / 其它轻量框架。
* ORM：Drizzle ORM / 直接 SQL。

### 4.3 选择与原因

采用 **Hono + Drizzle ORM**：

* Hono 适配 Workers、路由清晰、性能好。
* Drizzle 提供类型安全与易维护的数据库访问层。
